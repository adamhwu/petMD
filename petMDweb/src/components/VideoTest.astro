---
const { websocketUrl = "ws://<raspberry_pi_ip>:8765" } = Astro.props;
---

<div class="video-container">
  <img id="video-stream" alt="Live Video Stream" width="640" height="480" />
</div>

<script is:client>
  const socket = new WebSocket(import.meta.env.PUBLIC_SOCKET_URL || "{websocketUrl}");

  socket.addEventListener("message", (event) => {
    const img = document.getElementById("video-stream");
    img.src = "data:image/jpeg;base64," + event.data;
  });
</script>

<style>
  .video-container {
    display: flex;
    justify-content: center;
    align-items: center;
    border: 2px solid #ccc;
    border-radius: 12px;
    padding: 1rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    background: #000;
  }

  img {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
  }
</style>
